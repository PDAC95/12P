<div
  class="email-verification-banner"
  *ngIf="showEmailVerificationBanner && isUserLoggedIn"
>
  <div class="container">
    <div class="banner-content">
      <div class="banner-icon">
        <i class="fas fa-exclamation-triangle"></i>
      </div>
      <div class="banner-message">
        <strong>Email Verification Required</strong>
        <span class="email-text"
          >Please verify your email address ({{ userEmail }}) to access all
          features.</span
        >
      </div>
      <div class="banner-actions">
        <button class="btn btn-verify" (click)="goToEmailVerification()">
          Verify Email
        </button>
        <button
          class="btn btn-close"
          (click)="closeVerificationBanner()"
          title="Hide this message"
        >
          <i class="fas fa-times"></i>
        </button>
      </div>
    </div>
  </div>
</div>

<nav
  class="navbar navbar-expand-lg fixed-top"
  [class.navbar-scrolled]="isScrolled"
>
  <div class="container">
    <a class="navbar-brand d-flex align-items-center" routerLink="/">
      <img
        src="assets/images/logos/logo-navbar.png"
        alt="Plaice Real Estate"
        height="40"
        class="navbar-logo"
      />
    </a>

    <button
      class="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#navbarNav"
    >
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav mx-auto">
        <li class="nav-item">
          <a
            class="nav-link"
            routerLink="/"
            routerLinkActive="active"
            [routerLinkActiveOptions]="{exact: true}"
            >Home</a
          >
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="/properties" routerLinkActive="active"
            >Properties</a
          >
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="/ai-search" routerLinkActive="active"
            >AI Search</a
          >
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="/contact" routerLinkActive="active"
            >Contact</a
          >
        </li>
      </ul>

      <div class="d-flex align-items-center">
        <a
          *ngIf="isUserLoggedIn"
          routerLink="/favorites"
          class="favorites-nav-icon me-3"
          title="My Favorites"
        >
          <app-heart-icon
            [checked]="false"
            [disabled]="false"
            size="small"
          ></app-heart-icon>
        </a>

        <div class="user-dropdown-container position-relative me-3">
          <div class="user-avatar" (click)="toggleUserDropdown()">
            <img
              *ngIf="isUserLoggedIn"
              src="https://via.placeholder.com/40x40/016450/ffffff?text=U"
              alt="User"
              class="rounded-circle user-image"
              width="40"
              height="40"
            />
            <div *ngIf="!isUserLoggedIn" class="user-icon">
              <i class="fas fa-user"></i>
            </div>
          </div>

          <div
            class="user-dropdown"
            [class.show]="showUserDropdown"
            *ngIf="showUserDropdown"
          >
            <div *ngIf="!isUserLoggedIn" class="dropdown-content">
              <a routerLink="/auth/login" class="dropdown-item">
                <i class="fas fa-sign-in-alt"></i>
                <span>Login</span>
              </a>
              <a routerLink="/auth/register" class="dropdown-item">
                <i class="fas fa-user-plus"></i>
                <span>Sign Up</span>
              </a>
            </div>

            <div *ngIf="isUserLoggedIn" class="dropdown-content">
              <div class="user-info">
                <div class="user-name">{{ getUserDisplayName() }}</div>
                <div class="user-email">{{ getUserEmail() }}</div>
                <div class="user-role">{{ getUserRole() }}</div>
              </div>
              <div class="dropdown-divider"></div>
              <a routerLink="/users/profile" class="dropdown-item">
                <i class="fas fa-user"></i>
                <span>Profile</span>
              </a>
              <a routerLink="/dashboard" class="dropdown-item">
                <i class="fas fa-tachometer-alt"></i>
                <span>Dashboard</span>
              </a>
              <div class="dropdown-divider"></div>
              <button class="dropdown-item" (click)="onLogout()">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
              </button>
            </div>
          </div>
        </div>

        <button
          *ngIf="currentUser?.role === 'agent' || currentUser?.role === 'admin'"
          class="btn btn-primary btn-add-property"
          routerLink="/add-property"
        >
          Add Property
        </button>
      </div>
    </div>
  </div>
</nav>
